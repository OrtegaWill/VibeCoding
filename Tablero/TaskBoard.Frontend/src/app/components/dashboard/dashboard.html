<div class="dashboard">
  <!-- Dashboard Header -->
  <div class="dashboard-header">
    <h1 class="dashboard-title">ğŸ“Š TaskBoard Dashboard</h1>
    <p class="dashboard-subtitle">Gestiona tus proyectos con estilo Monday.com</p>
  </div>

  <!-- Metrics Grid - Monday.com Style Cards -->
  <div class="metrics-grid">
    <div class="metric-card">
      <div class="metric-icon">ğŸ“</div>
      <div class="metric-value">{{ totalTasks }}</div>
      <div class="metric-label">Total de Tareas</div>
      <div class="metric-change positive">
        <span>+12%</span>
        <span>vs Ãºltimo mes</span>
      </div>
    </div>

    <div class="metric-card">
      <div class="metric-icon">â³</div>
      <div class="metric-value">{{ tasksInProgress }}</div>
      <div class="metric-label">En Progreso</div>
      <div class="metric-change positive">
        <span>+5%</span>
        <span>vs Ãºltima semana</span>
      </div>
    </div>

    <div class="metric-card">
      <div class="metric-icon">âœ…</div>
      <div class="metric-value">{{ completedTasks }}</div>
      <div class="metric-label">Completadas</div>
      <div class="metric-change positive">
        <span>+18%</span>
        <span>excelente progreso</span>
      </div>
    </div>

    <div class="metric-card">
      <div class="metric-icon">ğŸ¯</div>
      <div class="metric-value">{{ completedTasks > 0 ? ((completedTasks / totalTasks) * 100).toFixed(0) : 0 }}%</div>
      <div class="metric-label">Tasa de Ã‰xito</div>
      <div class="metric-change positive">
        <span>ğŸ“ˆ</span>
        <span>tendencia alcista</span>
      </div>
    </div>
  </div>

  <!-- Content Grid - Kanban Style -->
  <div class="content-grid">
    <!-- Current Sprint Card -->
    <div class="content-card">
      <div class="card-header">
        <h2 class="card-title">
          <div class="card-icon" style="background: linear-gradient(135deg, #667eea, #764ba2);">
            ğŸš€
          </div>
          Sprint Actual
        </h2>
        <div class="card-actions">
          <button class="action-btn" (click)="showCreateSprintModal = true">
            Nuevo Sprint
          </button>
        </div>
      </div>

      <div *ngIf="currentSprint; else noCurrentSprint" class="sprint-info">
        <div class="sprint-item">
          <span class="sprint-label">ğŸ“‹ Nombre:</span>
          <span class="sprint-value">{{ currentSprint.name }}</span>
        </div>
        
        <div class="sprint-item">
          <span class="sprint-label">ğŸ“… Inicio:</span>
          <span class="sprint-value">{{ currentSprint.startDate | date: 'dd/MM/yyyy' }}</span>
        </div>
        
        <div class="sprint-item">
          <span class="sprint-label">ğŸ Fin:</span>
          <span class="sprint-value">{{ currentSprint.endDate | date: 'dd/MM/yyyy' }}</span>
        </div>
        
        <div class="sprint-item">
          <span class="sprint-label">ğŸ“Š Estado:</span>
          <span class="status-badge" 
                [ngClass]="{
                  'status-active': currentSprint.status === 'Active',
                  'status-completed': currentSprint.status === 'Completed',
                  'status-planned': currentSprint.status === 'Planned'
                }">
            {{ currentSprint.status }}
          </span>
        </div>

        <div class="sprint-item">
          <span class="sprint-label">ğŸ“ DescripciÃ³n:</span>
          <span class="sprint-value">{{ currentSprint.goal || 'Sin descripciÃ³n' }}</span>
        </div>
        
        <div class="sprint-item">
          <span class="sprint-label">âœ… Progreso:</span>
          <span class="sprint-value">
            {{ getSprintProgress() }}% completado
          </span>
        </div>
      </div>

      <ng-template #noCurrentSprint>
        <div class="empty-state">
          <div class="empty-state-icon">ğŸ¯</div>
          <div class="empty-state-title">No hay sprint activo</div>
          <div class="empty-state-description">
            Crea un nuevo sprint para comenzar a organizar tus tareas
          </div>
        </div>
      </ng-template>
    </div>

    <!-- Recent Tasks Card -->
    <div class="content-card">
      <div class="card-header">
        <h2 class="card-title">
          <div class="card-icon" style="background: linear-gradient(135deg, #ff6b6b, #ff8e8e);">
            ğŸ“‹
          </div>
          Tareas Recientes
        </h2>
        <div class="card-actions">
          <button class="action-btn secondary" (click)="showCreateTaskModal = true">
            Nueva Tarea
          </button>
        </div>
      </div>

      <div *ngIf="recentTasks.length > 0; else noRecentTasks" class="task-list">
        <div *ngFor="let task of recentTasks.slice(0, 8)" class="task-item">
          <div class="task-priority" 
               [ngClass]="{
                 'priority-high': task.priority === 'High' || task.priority === 'Critical',
                 'priority-medium': task.priority === 'Medium',
                 'priority-low': task.priority === 'Low'
               }">
          </div>
          
          <div class="task-content">
            <div class="task-title" [title]="task.title">{{ task.title }}</div>
            <div class="task-meta">
              <span class="task-status"
                    [ngClass]="{
                      'status-todo': task.status === TaskStatus.Todo,
                      'status-in-progress': task.status === TaskStatus.InProgress,
                      'status-done': task.status === TaskStatus.Done
                    }">
                {{ task.status }}
              </span>
              <span>{{ task.createdAt | date: 'dd/MM' }}</span>
              <span *ngIf="task.assignedTo">ğŸ‘¤ {{ task.assignedTo }}</span>
            </div>
          </div>
        </div>
      </div>

      <ng-template #noRecentTasks>
        <div class="empty-state">
          <div class="empty-state-icon">ğŸ“</div>
          <div class="empty-state-title">No hay tareas recientes</div>
          <div class="empty-state-description">
            Las tareas aparecerÃ¡n aquÃ­ cuando comiences a crearlas
          </div>
        </div>
      </ng-template>
    </div>
  </div>

  <!-- Activity Timeline Card -->
  <div class="content-card">
    <div class="card-header">
      <h2 class="card-title">
        <div class="card-icon" style="background: linear-gradient(135deg, #4ecdc4, #44a08d);">
          ğŸ“ˆ
        </div>
        Sprints del Proyecto
      </h2>
      <div class="card-actions">
        <button class="action-btn" style="background: linear-gradient(135deg, #4ecdc4, #44a08d);">
          Ver Kanban
        </button>
      </div>
    </div>

    <div *ngIf="recentSprints.length > 0; else noRecentSprints" class="task-list">
      <div *ngFor="let sprint of recentSprints.slice(0, 6)" class="task-item">
        <div class="task-priority priority-medium"></div>
        <div class="task-content">
          <div class="task-title">{{ sprint.name }}</div>
          <div class="task-meta">
            <span class="task-status" 
                  [ngClass]="{
                    'status-todo': sprint.status === 'Planned',
                    'status-in-progress': sprint.status === 'Active',
                    'status-done': sprint.status === 'Completed'
                  }">
              {{ sprint.status }}
            </span>
            <span>{{ sprint.startDate | date: 'dd/MM/yyyy' }} - {{ sprint.endDate | date: 'dd/MM/yyyy' }}</span>
          </div>
        </div>
      </div>
    </div>

    <ng-template #noRecentSprints>
      <div class="empty-state">
        <div class="empty-state-icon">âš¡</div>
        <div class="empty-state-title">No hay sprints</div>
        <div class="empty-state-description">
          Crea tu primer sprint para organizar las tareas
        </div>
      </div>
    </ng-template>
  </div>
</div>

<!-- Create Sprint Modal -->
<div *ngIf="showCreateSprintModal" class="modal-overlay" (click)="showCreateSprintModal = false">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>ğŸš€ Crear Nuevo Sprint</h3>
      <button class="close-btn" (click)="showCreateSprintModal = false">Ã—</button>
    </div>
    
    <form (ngSubmit)="createSprint()" class="modal-form">
      <div class="form-group">
        <label>Nombre del Sprint</label>
        <input 
          type="text" 
          [(ngModel)]="newSprint.name" 
          name="sprintName"
          placeholder="Ejemplo: Sprint de Desarrollo Q1"
          required>
      </div>

      <div class="form-group">
        <label>Objetivo</label>
        <textarea 
          [(ngModel)]="newSprint.goal" 
          name="sprintGoal"
          placeholder="Describe los objetivos de este sprint..."
          rows="3">
        </textarea>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>Fecha de Inicio</label>
          <input 
            type="date" 
            [(ngModel)]="newSprint.startDate" 
            name="sprintStartDate"
            required>
        </div>

        <div class="form-group">
          <label>Fecha de Fin</label>
          <input 
            type="date" 
            [(ngModel)]="newSprint.endDate" 
            name="sprintEndDate"
            required>
        </div>
      </div>

      <div class="modal-actions">
        <button type="button" class="btn-secondary" (click)="showCreateSprintModal = false">
          Cancelar
        </button>
        <button type="submit" class="btn-primary">
          ğŸš€ Crear Sprint
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Create Task Modal -->
<div *ngIf="showCreateTaskModal" class="modal-overlay" (click)="showCreateTaskModal = false">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>ğŸ“ Crear Nueva Tarea</h3>
      <button class="close-btn" (click)="showCreateTaskModal = false">Ã—</button>
    </div>
    
    <form (ngSubmit)="createTask()" class="modal-form">
      <div class="form-group">
        <label>TÃ­tulo de la Tarea</label>
        <input 
          type="text" 
          [(ngModel)]="newTask.title" 
          name="taskTitle"
          placeholder="Ejemplo: Implementar autenticaciÃ³n de usuarios"
          required>
      </div>

      <div class="form-group">
        <label>DescripciÃ³n</label>
        <textarea 
          [(ngModel)]="newTask.description" 
          name="taskDescription"
          placeholder="Describe los detalles de la tarea..."
          rows="3">
        </textarea>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>Prioridad</label>
          <select [(ngModel)]="newTask.priority" name="taskPriority" required>
            <option value="">Seleccionar prioridad</option>
            <option value="Low">ğŸŸ¢ Baja</option>
            <option value="Medium">ğŸŸ¡ Media</option>
            <option value="High">ğŸ”´ Alta</option>
            <option value="Critical">ğŸš¨ CrÃ­tica</option>
          </select>
        </div>

        <div class="form-group">
          <label>Sprint</label>
          <select [(ngModel)]="newTask.sprintId" name="taskSprint">
            <option value="">Sin sprint asignado</option>
            <option *ngFor="let sprint of sprints" [value]="sprint.id">
              {{ sprint.name }}
            </option>
          </select>
        </div>
      </div>

      <div class="form-group">
        <label>Asignado a</label>
        <input 
          type="text" 
          [(ngModel)]="newTask.assignedTo" 
          name="taskAssignee"
          placeholder="Nombre del responsable">
      </div>

      <div class="modal-actions">
        <button type="button" class="btn-secondary" (click)="showCreateTaskModal = false">
          Cancelar
        </button>
        <button type="submit" class="btn-primary">
          ğŸ“ Crear Tarea
        </button>
      </div>
    </form>
  </div>
</div>
